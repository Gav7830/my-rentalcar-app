
מסמך אפיון – פרויקט גמר I&G Rental Car   

מבצעי הפרוייקט (באישור אפריים)

ישראל איגלה: 054-7913390             iglisr@gmail.com 

גבי דביר: 052-8966762       emailgavriel@gmail.com

מספר מחזור:  D130222

**תיאור הפרוייקט:**

**מערכת ניהול השכרת רכבים**, המערכת מאפשרת ל**מנהלי אדמיניסטרציה** של חברת ההשכרה לנהל את צי הרכבים בחברה, ניתן לייצור, לעדכן ולמחוק כרטיסי רכבים במלאי. כל הנתונים כולל התמונות נשמרים בתוך

כמו כן, מנהל אדמין יכול לצפות בכל ההזמנות שבוצעו בחברה ולמחוק הזמנות לא מתאימות. 

**צד המשתמש-לקוח:** לאחר ביצוע רישום וכניסה למערכת, המערכת מאפשרת לצפות במלאי הרכבים, לבצע הזמנת רכב לפי מיקום תאריכים ובחירת רכב מתאים.


הפרוייקט נכתב בדגש על תצוגה רספונסיבית.

**דף ראשי**: ובו מוצג כל מלאי הרכבים כאשר כל כלי רכב מוצג בכרטיסיה משל עצמו עם תיאור קצר המכיל שם חברת הרכב, דגם, תמונה ועלות השכרה יומית.

**סינון -** קיימת אפשרות לסנן את כלי הרכב במלאי לפי שם הרכב ו/או דגם הרכב או לפי תיבת טקסט חופשי.

בתחתית הדף  קיים **Footer** המשותף לכל דפי האתר קיימים קישורים הבאים: Facebook, Youtube & Tweeter

קיימים קישורים לדפי אתר כגון: Terms Of Use, Privacy Policy & Cookie Policy.

וכמובן כותרת המודיעה על זכויות יוצרים.


**דף אודות :** דף זה מכיל מידע אודות החברה שמות הבעלים, שנת הקמת החברה וחזון החברה.


**כניסה ושימוש במערכת ע"י מנהל אדמין:**

כניסת אדמין למערכת תאופשר ע"י הקלדת שם משתמש  Admin וסיסמה Admin123.

**הוספת רכב -**  סמן הפלוס יתווסף אוטומטית בראש תצוגת הרכבים מימין לתיבת החיפוש, לחיצה על סימן הפלוס תוביל לכרטיסיה שבה יוגדר הרכב החדש, בתוך הכרטיסייה ניתן לבחור את פרטי הרכב החדש כגון: יצרן מודל שנת ייצור, עלות יומית (שדות חובה) ותמונת הרכב החדש (לא חובה).

לחיצה נוספת על סימן הפלוס בכרטיסיה תשמור את הרכב החדש במערכת.

**מלאי רכבים התחלתי** מייד לאחר טעינת האפליקציה וביצוע ה Migration, תווצר ותטען טבלת רכבים הטעומה בשישה רכבים.

**עריכת רכב** - לחיצה על כל אחד מכרטיסי הרכבים במערכת תפתח כרטיסיית עריכת רכבים ובה מופיע הרכב עם פרטיו במצב עריכה, ניתן לעדכן פרטים נחוצים ובסיום יש ללחוץ על כפתור שמירת העדכון או לחלופין לבטלו, או למחוק את כרטיס הרכב.

**מחיקת רכב** -  מתוך מצב עריכה יש ללחוץ על כפתור מחיקה כדי להסיר את הרכב מהמלאי.

**רשימת כל ההזמנות במערכת :** פירוט כל הזמנות הרכבים במערכת, בדף זה מוצגים כל הזמנות הרכבים לפי סדר יורד ובו מפורטים תאריך ההזמנה שם משתמש מלא, יצרן, מודל, מיקום, תאריך לקיחת הרכב, תאריך החזרת הרכב ועלות כוללת לכל תקופת ההשכרה.

ניתן לסנן את רשימת ההזמנות לפי שם מבצע ההזמנה.

**מחיקת הזמנה**: לחיצה על אייקון מחיקה (פח אשפה) תוביל לחלון אישור בקשת מחיקה ולאחר האישור הנדרש תבוצע המחיקה ממאגר המידע.

- מאגר המידע נמצא על גבי **שרת SQL**


**כניסה ושימוש במערכת ע"י משתמש רגיל:**

דף הבית: ברירת המחדל של דף הבית פורסת לפני המשתמש שלושה כרטיסי רכבים.  

לחיצה על כרטיס רכב כלשהו תוביל לדף הזמנת רכבים.

קיימים שלושה סוגי מסננים תצוגת רכבים:

1. יצרן הרכב
1. מודל
1. טקסט חופשי – מאפשר סינון של ייצרן הרכב או מודל ע"י הקלדת חלק משם היצרן או שם המודל.

בתחתית הדף מצד ימין - ניתן לקבוע את כמות תצוגת כרטיסי הרכב בכל עמוד.

בתחתית הדף מצד שמאל - ניתן לעבור לדף תצוגת רכבים שונה ע"י לחיצה על אחד ממספרי הדף. 

כמו כן ניתן ללחוץ על החיצים כדי להגיע לארבעת העמודים הבאים/הקודמים.

**כניסה ושימוש במערכת ע"י משתמש רשום במערכת:**

דף הזמנת רכבים: דרישת המערכת לפני הזמנת הרכב היא ביצוע כניסת משתמש קיים במערכת.

ביצוע רישום המשתמש במערכת: לחץ על כפתור Join/Sign in -> Join Now

יפתח לפניך דף הרשמת המשתמש למערכת, יש לעדכן את הפרטים הבאים:

שם פרטי

שם משפחה

כתובת מייל

אישור כתובת מייל

שם משתמש

סיסמה המכילה לפחות 8 תווים, לפחות אות אחת ולפחות ספרה אחת

אישור סיסמה: יש להקליד את הסיסמה בשנית

תמונת פרופיל משתמש: ניתן להעלות תמונת פרופיל בהגבלת גודל וסוג תמונה.

- כל השדות הנ"ל הן שדות חובה
- קיים במערכת משתמש אחד לדוגמה: שם משתמש-  User, סיסמה User123

בסיום תהליך ההרשמה יש ללחוץ שמירה.

כעת השם מוכר למערכת ויש לבצע Sign in ע"י כניסת משתמש קיים. 

שם המשתמש יופיע בכותרת האתר מהווה אישור לכך שהמשתמש נכנס למערכת.

בשלב זה המשתמש יכול ללחוץ על כרטיס אחד ברכבים המצגים ומשם להזמנת רכבים או לעבור ישירות לדף הזמנת רכבים.

כל התהליך הרשמת משתמש וסיסמתו מתבצעים באופן מאובטח באמצעות העברת Token וריענונו כל 30 שניות כדי לשמור על מצב זיהוי פעיל.

**דף הזמנת רכבים:**

הדף מכיל שלושה שדות :  

1. מיקום, שדה מסוג תפריט נפתח המכיל את רוב שמות הערים בעולם ניתן גם להקליד שם עיר או קוד שדה תעופה.
1. תאריך לקיחת הרכב - לא ניתן לבחור תאריך בעבר.
1. תאריך החזרת הרכב - לא ניתן לבחור תאריך מוקדם מתאריך לקיחה.

בשלב הבא יש ללחוץ על כרטיס הרכב הרצוי ואז יפתח חלון **ובו מידע נוסף** שבו מוצגים כל פרטי הרכב עלות כוללת לכל תקופת השכירות, בנוסף קיימת אפשרות ללחוץ על פרטים נוספים ושם ייחשף מידע אודות סוג האנרגיה המניע את הרכב וכמות הדלתות ברכב. אם לא מעוניינים ברכב זה, יש ללחוץ על סימן האיקס המהווה סגירת חלון ולהתחיל שוב את בחירת הרכב.

לחץ על סקירת סיכום ההזמנה **(Review Order)** כדי לעבור לשלב האחרון של ההזמנה.

**סקירת סיכום ההזמנה**

בשלב זה יפתח לפניך דף סיכום הזמנה ובו כל פרטי ההזמנה. יש לאשר או לדחות ע"י לחיצה "אחורה" (כאשר בשלב זה ישמרו פרטי מיקום ותקופת  שכירות הרכב).

לחיצה על אישור ההזמנה תלווה ב"טוסט" המאשר את הלחיצה והמערכת תשמור את פרטי ההזמנה במערכת.

בכל שלב בתהליך ההרשמה או מילוי טופס דאגנו לבצע אימות שדות קלט.

במידה ומשתמש מנסה להקליד את כתובת URL שגויה המערכת תעבירו לדף הודעת שגיאה 404.


**דרכי התממשקות עם המערכת:**

כתובת האתר: <https://localhost:7187>

להלן פירוט נקודות ה API

**משתמשים GetAllUsers** – פונקציה המחזירה את רשימת כל המשתמשים הרשומים במערכת
Login – פרמטרים: 

User: {

UserId,FirstName,LastName , UserName , Password , Email , ImageName , ImageData , RefreshToken , RefreshTokenExpires , RoleId }

בהצלחת הפעולה מחזירה: 

LoginResponse: {TokensData: { AccessToken , AccessTokenExpires , RefreshToken , DateTime RefreshTokenExpires , ExpiresInSeconds }, UserResponse: { UserId , UserName , FirstName , LastName , RoleID , RoleName }}

ובמקרה של כישלון המערכת מחזירה הודעה "token invalid" עם סטטוס קוד 401 (Unauthorized)

**RefreshToken – פרמטרים: TokensData**

פונקציה המקבלת TokensData במידה ולא פג תוקפו וע"פ בדיקת השרת יש התאמה בין ה- TokensData  למשתמש (User), השרת יחזיר LoginResponse.

**PostUserWithImage – פרמטרים: UserWithImage** (User יחד עם קובץ)

במידה ונעשה ניסיון העלאת קובץ שגודלו מתחת 1MB, וכמות התווים המקסימלית לשם הקובץ היא 32 תווים וסיומת הקובץ היא אחת מהשמות הבאים (bmp, gif, png, jpg, jpeg) אזי השרת יפעיל את תהליך ההרשמה של משתמש (,Register הכוללת בדיקות וולידציה נוספות בצד השרת). כמובן שקיימות בדיקות אימות שדות גם בצד הקליינט.

במידה ולא נשלח קובץ או שנשלח קובץ בפורמט לא נכון, תוחזר הודעה בהתאם יחד עם סטטוס קוד 400 (Bad Request).

**Register – פרמטרים: User**

במידה ושם משתמש או מייל קיימים במאגר מידע, השרת יחזיר הודעת שגיאה בהתאם עם סטטוס קוד 400. ואם לא אז תתבצע בהצלחה הרשמה של משתמש חדש מסוג יוזר.

**הזמנות GetOrders – פרמטרים:userId** 

כל משתמש במערכת מוקצה ID. המערכת מחזירה את כל ההזמנות שביצע אותו משתמש בעל אותו , ID במידה וid   קטן מערך 1 תוחזר רשימת כל ההזמנות הקיימות במאגר המידע (ראה עמוד Orders List)

**PostOrder** 

שמירת ההזמנה תבוצע לאחר ביצוע אימות: קבלת בקשת  order ווידוא

תאריך התחלה גדול או שווה להיום ותאריך סיום גדול מתאריך התחלה. 

במידה ולא תשלח הודאת שגיאה בהתאם.

**מיקומים GetLocations**

בקשת מיקומים מתבצעת לפי airportCode, city  והחזרת מיקומים בהתאם

**רכבים GetCarsCount:** 

מקבל סוג בקשה, תצוגת דף הבית (כל הרכבים במאגר המידע) לעומת תצוגת רכבים הפנויים להזמנה.

חישוב הרכבים הפנויים להזמנה נקבע לפי חפיפת תאריכים במידה ורכב הוזמן בתאריכים החופפים להזמנה קיימת המערכת לא תציגם.

ובנוסף מקבל את שלושת מזהי סינון הבאים:

מזהה יצרן.

מזהה מודל

טקסט חופשי

ומחזירה כמות רכבים בהתאם לסינון.

**GetCars:** מבצעת בקשה בעלת פרמטרים זהים ל GetCarsCount ובנוסף כמות רכבים בעמוד, מספר העמוד, ומחזירה את רשימת הרכבים.

**PostCarWithImage:** מבצע בדיקות אימות קובץ תמונה וקורא ל PostCar

**PostCar** יצירת רכב חדש במאגר

**PutCarWithImage** בדיקת קובץ תמונה 

**PutCar** שליחת מזהה מודל, ייצרן, שנה וביצוע עדכון במאגר המידע

**DeleteCar** שליחת מזהה רכב וביצוע מחיקה ממאגר המידע

**מודלים GetAllCarModels** פונקציה המחזירה את כל רשימת המודלים עם כל פרמטרי מס דלתות סוג גיר, סוג אנרגיה.

**GetCarModelsByCarCompanyNameID** פונקציה המחזירה את רשימת המודלים לפי מזהה יצרן

**יצרני רכבים GetAllCarCompanyNames** פונקציה המחזירה רשימת כל יצרני הרכבים.

**CachedOrderService CachedCarService** : שומרים את תוצאות הפניה הקודמת בקש כדי לשפר ביצועי שליפת מידע. 
Thursday, October 27, 2022

במידה ולא , השרת יחזיר הודעה "token invalid".







